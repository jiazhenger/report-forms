(this["webpackJsonpreact-report-forms"]=this["webpackJsonpreact-report-forms"]||[]).push([[16,52],{24:function(t,e,n){"use strict";n.r(e),n.d(e,"default",(function(){return u}));var a=n(12),r=n(13),i=n(15),l=n(14),o=n(0),c=n.n(o),d=n(43),s=n(57),f=function(t){var e=t.label,n=t.id,a=(t.hasNode,t.onClick);return c.a.createElement("li",{id:n,className:"tap cp h fxmc plr10",onClick:a},c.a.createElement("div",null,c.a.createElement("h3",{className:"f12 tc"},e)))},h=window,m=h.$fn,p=h.$http,u=function(t){Object(i.a)(n,t);var e=Object(l.a)(n);function n(){var t;Object(a.a)(this,n);for(var r=arguments.length,i=new Array(r),l=0;l<r;l++)i[l]=arguments[l];return(t=e.call.apply(e,[this].concat(i))).state={},t.getHtml=function(){var e=t.getLastHtml(),n=e.mainHtml,a=e.headerHtml,r=e.footerHtml,i=t.paper,l=parseInt(i.width)+20+"px";return"\n\t\t\t<!DOCTYPE html>\n\t\t\t<html lang='en'>\n\t\t\t<head>\n\t\t\t\t<meta charset='utf-8' />\n\t\t\t\t<meta name='renderer' content='webkit' />\n\t\t\t\t<meta name='viewport' content='width=device-width,user-scalable=no,initial-scale=1.0,shrink-to-fit=no,minimum-scale=1.0,maximum-scale=1.0,minimal-ui,viewport-fit=cover'/>\n\t\t\t\t<title>".concat(i.name,"</title>\n\t\t\t\t<style>\n\t\t\t\t\thtml,body{width:100%;height:100%;font:12px/20px 'Tahoma,Verdana,Arial,sans-serif'; color:#333}\n\t\t\t\t\t*{margin:0;padding:0;box-sizing:border-box}\n\t\t\t\t\timg{border:0;display:block}\n\t\t\t\t\ttable{width:100%;border-collapse:collapse;border-spacing:0}\n\t\t\t\t\t.fxmc{display:flex; align-items: center;justify-content: center}\n\t\t\t\t\tfooter,header,main{position:relative;}\n\t\t\t\t\t.container{position:relative;margin:0 auto;border:1px solid #999;padding:10px}\n\t\t\t\t\t[type='pages']{visibility:hidden}\n\t\t\t\t</style>\n\t\t\t</head>\n\t\t\t<body>\n\t\t\t\t<div class='container' name='").concat(i.name,"' style='width:").concat(l,";min-height:100%;'>\n\t\t\t\t\t").concat(a,"</header>\n\t\t\t\t\t").concat(n,"\n\t\t\t\t\t").concat(r,"\n\t\t\t\t</div>\n\t\t\t\t<script>\n\t\t\t\t\tfunction resize(){\n\t\t\t\t\t\tconst box = document.querySelector('.container');\n\t\t\t\t\t\tbox.style.height = document.body.scrollHeight + 'px'\n\t\t\t\t\t}\n\t\t\t\t\tresize();\n\t\t\t\t\twindow.onresize = resize\n\t\t\t\t<\/script>\n\t\t\t</body>\n\t\t\t</html>\n\t\t")},t.createPdf=function(){if(!t.getLocalHtml())return m.toast("\u65e0\u5185\u5bb9");var e=t.paper,n=t.__preview.clone();n.children().removeStyle("marginTop"),p.submit(null,"pdf",{param:{main:n.html(),format:e.format,name:e.name,source:t.getSource(e)}}).then((function(t){m.toast("\u751f\u6210 pdf \u6210\u529f")}))},t.getSource=function(e){var n=m.local("myWidth"),a=m.local("myHeight"),r=t.getLocalHtml(),i=document.createElement("section"),l=document.createElement("div"),o={format:e.format,width:e.width,height:e.height,name:e.name,myWidth:n,myHeight:a};return i.setAttribute("data",JSON.stringify(o)),i.innerHTML=r,l.appendChild(i),l.innerHTML},t.createHtml=function(){var e=t.paper,n=t.getHtml(e);d.default.isString(n)&&(n=n.replace(/[\n\r\t]/g,"")),p.submit(null,"html",{param:{html:n,name:e.name,source:t.getSource(e)}}).then((function(t){m.toast("\u751f\u6210 html \u6210\u529f")}))},t.downloadPdf=function(){window.open(window.$config.api+"downloadPdf?="+t.reportName)},t.downloadHtml=function(){window.open(window.$config.api+"downloadHtml?name"+t.reportName)},t.print=function(){var e=t.__preview.clone();e.finds(".paper-page").removeStyle("marginTop");var n=e.html(),a="\n\t\t    <!DOCTYPE html>\n\t\t    <html lang='en'>\n\t\t    <head>\n\t\t    \t<meta charset='utf-8' />\n\t\t    \t<meta name='renderer' content='webkit' />\n\t\t    \t<meta name='viewport' content='width=device-width,user-scalable=no,initial-scale=1.0,shrink-to-fit=no,minimum-scale=1.0,maximum-scale=1.0,minimal-ui,viewport-fit=cover'/>\n\t\t    \t<title>".concat(t.paper.name,"</title>\n\t\t    \t<style>\n\t\t    \t\thtml,body{width:100%;height:100%;font:12px/20px 'Tahoma,Verdana,Arial,sans-serif'; color:#333}\n\t\t    \t\t*{margin:0;padding:0;box-sizing:border-box}\n\t\t    \t\timg{border:0;display:block}\n\t\t    \t\ttable{width:100%;border-collapse:collapse;border-spacing:0}\n\t\t    \t\t.fxmc{display:flex; align-items: center;justify-content: center}\n\t\t    \t</style>\n\t\t    </head>\n\t\t    <body>\n\t\t        ").concat(n,"\n\t\t    </body>\n\t\t    </html>\n\t\t");Object(d.default)("#iframe").remove();var r=document.createElement("iframe");Object(d.default)(r).id("iframe").cssText("position:absolute;visibility:hidden").appendTo(document.body);var i=r.contentDocument;i.open(),i.write(a),i.close(),r.contentWindow.focus(),r.contentWindow.print()},t}return Object(r.a)(n,[{key:"componentDidMount",value:function(){this.html=this.getLocalHtml(),this.paper=m.local("paper"),this.setState({paperWidth:this.paper.width}),this.__preview=Object(d.default)("#preview"),this.preview(),Object(d.default)(document.body).unonce("mouseup")}},{key:"getLocalHtml",value:function(){var t=m.local("html");return t||"<div class='tc g9 pt30'>\u6682\u65e0\u5185\u5bb9</div>"}},{key:"preview",value:function(){var t=this,e=this.getLastHtml(),n=e.mainHtml,a=e.headerHtml,r=e.footerHtml,i=e.headerHeight,l=e.footerHeight,o=parseInt(this.paper.height)-i-l,c=0;!function e(n){var s=document.createElement("div"),f=Object(d.default)(s).addClass("paper-page bcf").style({width:t.paper.width||"810px",height:t.paper.height||"100%",padding:"10px",boxSizing:"content-box"});c>0&&f.style("marginTop","10px"),""!==a&&d.default.toNode(a).children(0).appendTo(s);var h=d.default.toNode(n),m=h.find(".main");m.el?(h.children(0).appendTo(s).height(parseInt(t.paper.height)-i-l),f.style({display:"flex",flexDirection:"column"})):h.appendTo(s).style({position:"relative"}),""!==r&&d.default.toNode(r).children(0).appendTo(s),t.__preview.append(s);var p=m.el?m:f,u=p.getOffset().offsetTop;c++;var g=p.clone().clear();p.finds(".drag").each((function(t){var n=t.attr("type"),a=t.marginTop();if("table"===n&&t.find(".x-bind-table").el&&t.outerHeight()+a>o){var r=t.clone(),i=r.find("tbody").clear();t.finds("tr").each((function(t,e){var n=t.getInfo();n.offsetTop+n.offsetHeight-u>o&&i.append(t)})),g.append(r),e(g.htmls())}else{var l=t.getInfo();l.offsetTop+l.offsetHeight-u>o+a&&g.append(t),g.children().length()>0&&(g.children(0).removeStyle("marginTop"),e(g.htmls()))}})),Object(d.default)(document).finds(".pageNumber").each((function(t){return t.text(t.parent(".paper-page").index()+1)})),Object(d.default)(document).finds(".totalPages").each((function(e){return e.text(t.__preview.children().length())}))}(n)}},{key:"getData",value:function(t){var e=m.local("dataSource");return s.default.renderData(e.dataSource1,"dataSource1",t,!0),t.html()}},{key:"getLastHtml",value:function(t){var e=d.default.toNode(this.getLocalHtml());this.getData(e);var n=this.paper,a=e.find(".header"),r=e.find(".footer"),i=e.find(".main"),l=0,o=0,c=0,s="",f=e.html(),h="";if(e.finds("table").each((function(t){var e=t.parents(".drag");e.attr("rootUrl")&&e.removeStyle("height")})),a.el&&(a.style("position","relative").removeStyle("left,top,marginTop,marginBottom"),l=a.height(),t&&a.width(n.width).style("transform","scale(".concat(.713,")")),s=a.htmls()),r.el&&(r.style("position","relative").removeStyle("left,top,marginTop,marginBottom"),o=r.height(),t&&(o=.713*r.height(),r.width(n.width).style("transform","scale(".concat(.713,")"))),h=r.htmls()),i.el){if(i.style("position","relative").removeStyle("height,left,top,marginTop,marginBottom"),t){var m=i.children(0);1===i.children().length()&&m.find(".x-bind-table")&&m.style("position","absolute")}c=i.height(),f=i.htmls()}else(r.el||a.el)&&(f="");return{mainHtml:f,headerHtml:s,footerHtml:h,headerHeight:l,footerHeight:o,mainHeight:c}}},{key:"render",value:function(){return c.a.createElement("div",{className:"wh fv"},c.a.createElement("header",{className:"fxm plr10 bcf bbor1 nosel",style:{height:"30px"}},c.a.createElement("div",{className:"ex h"},c.a.createElement("ul",{className:"fxmc h"},c.a.createElement(f,{label:"\u751f\u6210 html",onClick:this.createHtml}),c.a.createElement(f,{label:"\u751f\u6210 pdf",onClick:this.createPdf}),c.a.createElement(f,{label:"\u4e0b\u8f7d pdf",onClick:this.downloadPdf}),c.a.createElement(f,{label:"\u4e0b\u8f7d html",onClick:this.downloadHtml}),c.a.createElement(f,{label:"\u6253\u5370",onClick:this.print})))),c.a.createElement("div",{className:"ex rel",style:{margin:"5px"}},c.a.createElement("div",{className:"abs_full scroll fxc f12 lh20"},c.a.createElement("div",{id:"preview"}))))}}]),n}(c.a.Component)},57:function(t,e,n){"use strict";n.r(e);var a=n(5),r=n(7),i=n(44),l=n(43),o=n(48),c=n(45),d=window.$fn;e.default={formatData:function(t,e,n,a){var i=this,l=0;return function t(o,c,s){s=s||e;var f=!1;return 0===l&&(f=!!d.hasArray(o)&&"/0",l++),o=d.hasArray(o)?o[0]:o,d.hasObject(o)&&Object.keys(o).forEach((function(l,h){var m=d.hasArray(o[l])?"/0":"",p=f?s+f+"/"+l+m:s+"/"+l+m,u={name:l,url:p,root:e,checked:n===p};u.parentUrl=i.getParentUrl(p),c[h]="object"===typeof o[l]?Object(r.a)(Object(r.a)({},u),{},{children:[]}):Object(r.a)(Object(r.a)({},u),{},{value:o[l],isString:1}),"table"===a||("ul"===a?"object"!==typeof o[l]&&(c[h].disabled=!0):("object"===typeof o[l]&&(c[h].disabled=!0),i.isArray(p)&&(c[h].disabled=!0))),"object"===typeof o[l]&&(d.isArray(o[l])?c[h].isArray=1:d.isObject(o[l])&&(c[h].isObject=1),t(o[l],c[h].children,p))})),c}(t,[])},formatCheckedData:function(t,e,n){return function t(e,a){return e.forEach((function(e,r){e.url===a?e.checked=1:e.checked=0,d.hasArray(e.children)&&(n&&(e.disabled=!0),t(e.children,a))})),e}(t,e.url)},getField:function(t){return"string"===typeof t?t.split("/"):null},getData:function(t,e){if("string"===typeof e){var n=e.split("/"),a=t;return n.forEach((function(t){a=a[t]})),a}return null},parse:function(t,e){if("string"===typeof e){var n=e.split("/");isNaN(+n[n.length-1])||n.pop();for(var a=0;a<n.length;){var r=n[a];r=isNaN(+r)?r:+r,"object"===typeof t&&(t=t[r]),a++}return t}return null},parseParent:function(t,e){if("string"===typeof e){var n=e.split("/");(n=n.filter((function(t){return isNaN(+t)}))).shift(),n.pop();for(var a=0;a<n.length;){t=t[n[a]]||{},a++}return t}return{}},isArray:function(t){var e=t.split("/"),n=e.length;return!isNaN(e[n-1])},isArrayChild:function(t){var e=t.split("/"),n=e.length;return!isNaN(e[n-2])},getParentUrl:function(t){if(l.default.isString(t)){var e=t.split("/");return this.isArray(t)?(e=e.filter((function(t){return isNaN(+t)}))).pop():e.pop(),e.join("/")}return""},getUrlField:function(t){if(l.default.isString(t)){var e=t.split("/");return e[e.length-1]}return""},getRootUrl:function(t){return l.default.isString(t)?t.split("/")[0]:""},getUrlData:function(t,e){var n=Object(r.a)({rootUrl:null,data:[],callback:null},e),i=n.rootUrl,o=n.data,c=t.attr("url");if(l.default.isString(c)){var d=c.split("/");d[0]=i,c=d.join("/"),t.attr({url:c});var s=this.parse(Object(a.a)({},i,o),this.getParentUrl(c)),f=this.parse(Object(a.a)({},i,o),c);(l.default.hasArray(s)||l.default.hasObject(s))&&n.callback&&n.callback(f,s,c)}},isContent:function(t){return 0===t.finds("code").length()},renderData:function(t,e,n,a){var r=this;return n.finds(".x-bind-url").each((function(n){r.getUrlData(n,{data:t,rootUrl:e,callback:function(t,e,l){var o=n.attr("type");"text"===o?a?n.text(t):n.html(i.default.bindField(r.getUrlField(l))):"img"===o?n.find("img").src(t):"barcode"===o?i.default.createBarcode(n,t):"qrcode"===o?i.default.createQrcode(n,t):"checkbox"===o&&i.default.createCheckbox(n,t)}})})),n.finds("table").each((function(n){if(0!==n.finds(".x-bind-table").length()||0!==n.finds("code").length()){n.parent(".drag").removeStyle("height");var d=n.find("tbody"),s=[];d.finds("td").each((function(t){t.attr("url")&&s.push(t.attr("url"))})),r.getUrlData(d.find("td"),{data:t,rootUrl:e,isParent:!0,callback:function(t,e,r){var i=d.find("tr").children().length(),s=d.children().length();if(l.default.hasArray(e)){var f=a?e.length:1,h=c.tableConfig.style;if(0===+n.attr("border")&&delete h.border,f!==s){var m=o.default.createTbody({row:f,col:i,td:{style:h,className:"loopNode x-bind-table",attr:{type:"text"}}});d.html(m.innerHTML)}}}}),d.finds("tr").each((function(n,l){n.children().each((function(n,o){n.hasClass("x-bind-table")&&(n.attr("url",s[o]),r.getUrlData(n,{data:t,rootUrl:e,callback:function(t,e,o){var c=r.getUrlField(o);if(a){var d=e[l];d&&n.text(d[c])}else n.html(i.default.bindField(c))}}))}))}))}})),n.finds(".drag").each((function(t){t.attr("rootUrl")&&t.attr({rootUrl:e})})),n}}}}]);